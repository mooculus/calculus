\NeedsTeXFormat{LaTeX2e}% LaTeX 2.09 can't be used (nor non-LaTeX)
[1994/12/01]% LaTeX date must be December 1994 or later
\ProvidesPackage{luluE}[2015/12/17 v0.75]
\ProcessOptions\relax

\usepackage{stix}
\usepackage[T1]{fontenc} %% CLOBBERS \d !!!
\renewcommand{\d}{\mathop{}\!d} %% unclobbers \d

\usepackage{gillius}
\usepackage{ccicons}

%\gilliuscondensed 
\usepackage{microtype}

\usepackage{imakeidx}
\makeindex[intoc]
\renewcommand{\dfn}[1]{\textbf{#1}\index{#1}}
\renewcommand{\vec}[1]{\mathbf{#1}} %% somehow clobbered

\renewcommand{\d}{\mathop{}\!d\!} %% Looks better with stix

\usepackage[framemethod=TikZ]{mdframed}

%% Size of the page
\usepackage[margin=.5in, includehead, includefoot, hmargin={.8in,.5in}, paperwidth=8.5in, paperheight=8.5in]{geometry}
%\usepackage[margin=.5in, includehead, includefoot, hmargin={.8in,.5in}, paperwidth=9in, paperheight=7in]{geometry}


% Store usual maketitle as othermaketitle
\let\othermaketitle\maketitle


\makeatletter
% % Redefine maketitle to give course packet title page and toc.
\renewcommand{\maketitle}{ %
\pagestyle{empty}
\onecolumn
\begin{flushright}
  \begin{tikzpicture}[opacity=1]
  \node at (-.8,0) {\scalebox{4}{\Huge\textsf{\textbf{\textcolor{black}{calculus}}}}};
  \node at (8,.25) {\scalebox{10}{\Huge\textsf{\textbf{\textcolor{gray}{e}}}}};  %% Aligned with subtitle
  %\node at (8,1.85) {\scalebox{10}{\Huge\textsf{\textbf{\textcolor{gray}{1}}}}}; %% Aligned with title
  \node at (-.7,-1.6) {\resizebox{4.8in}{.2in}{\Huge\textsf{\textcolor{gray}
          {with free online interactive materials}
    }}};
    %\draw[yellow] (-9,-1.2)--(9,-1.2); %guide line
\end{tikzpicture}\hspace*{.1in}

  \vspace{1cm}

  \begin{tikzpicture}[scale=.9,opacity =1,declare function = {f(\x) = sin(deg(\x))/\x;}]]
    \begin{axis}[
        xmin=-16,
        xmax=16,
        ymin=-2,
        ymax=2.5,
        width=8.2in,
        height=4in,
        axis lines=middle, %xlabel=$x$, ylabel=$y$,
        every axis y label/.style={gray,at=(current axis.above origin),anchor=south},
        every axis x label/.style={gray,at=(current axis.right of origin),anchor=west},
        ticks=none,
        axis line style={gray},
      ]
         
      \addplot [ultra thick,dashed, gray, smooth,samples=100,domain=-6:6] {1. -0.166667 *x^2+0.00833333 *x^4}; %% 
      \addplot [ultra thick,dashed, gray, smooth,samples=100,domain=-8:8] {1. -0.166667 *x^2+0.00833333 *x^4-0.000198413 *x^6+2.75573*10^(-6) *x^8-2.50521*10^(-8) *x^10};
      \addplot [ultra thick,dashed, gray, smooth,samples=100,domain=-10:10] {1. - 0.166667*x^2 + 0.00833333*x^4 - 0.000198413*x^6 + 2.75573*10^(-6)*x^8 - 2.50521*10^(-8)*x^10 + 1.6059*10^(-10)*x^12 - 7.64716*10^(-13) *x^14};
      \addplot [ultra thick,dashed, gray, smooth,samples=100,domain=-12:12] {1. -0.166667*x^2+0.00833333*x^4-0.000198413*x^6+2.75573*10^(-6)*x^8-2.50521*10^(-8) *x^10+1.6059*10^(-10)*x^12-7.64716*10^(-13) *x^14+2.81146*10^(-15) *x^16-8.22064*10^(-18) *x^18+1.95729*10^(-20)*x^20};
      \addplot [ultra thick,dashed, gray, smooth,samples=100,domain=-14:14] {1. -0.166667 *x^2+0.00833333 *x^4-0.000198413* x^6+2.75573*10^(-6)* x^8-2.50521*10^(-8)* x^10+1.6059*10^(-10)* x^12-7.64716*10^(-13)* x^14+2.81146*10^(-15)* x^16-8.22064*10^(-18)* x^18+1.95729*10^(-20)* x^20-3.86817*10^(-23)* x^22+6.44695*10^(-26)*x^24};
      \addplot [ultra thick,dashed, gray, smooth,samples=100,domain=-16:16] {1. -0.166667* x^2+0.00833333* x^4-0.000198413* x^6+2.75573*10^(-6)* x^8-2.50521*10^(-8)* x^10+1.6059*10^(-10)* x^12-7.64716*10^(-13)* x^14+2.81146*10^(-15)* x^16-8.22064*10^(-18)* x^18+1.95729*10^(-20)* x^20-3.86817*10^(-23)* x^22+6.44695*10^(-26)* x^24-9.18369*10^(-29)* x^26+1.131*10^(-31)* x^28-1.21613*10^(-34)* x^30+1.15163*10^(-37)* x^32-9.67759*10^(-41)* x^34};
      
      %% Sinc
      \addplot [ultra thick, gray, smooth,samples=100,domain=-16:16] {f(x)}; %% sinc
    \end{axis}
  \end{tikzpicture}\hspace*{.58in}
\end{flushright}
\vspace{-.4in}
\begin{flushleft}\hspace*{-.12in}
\begin{tikzpicture}
  \node[anchor=west] at (0,0) {\scalebox{1}{\Huge\textsf{\ccbyncsa}}};
  \node[anchor=west] at (4,-.25) {\large\textsf{developed in \textbf{XIMERA}}};
  \node[anchor=east] at (7in,-.25) {\small\textsf{This document was typeset on \today.}};
\end{tikzpicture}
\end{flushleft}
\thispagestyle{empty}
\newpage

~\vfill

\noindent
Copyright \copyright\ \the\year\ Jim Fowler and Bart Snapp

\noindent
This work is licensed under the Creative Commons
Attribution-NonCommercial-ShareAlike License. To view a copy of this
license, visit \url{http://creativecommons.org/licenses/by-nc-sa/4.0/}

If you distribute this work or a derivative, include the history of
the document.  The source code is available at:

\url{http://github.com/mooculus/calculus/}

\noindent
This text contains source material from several other open-source
texts:
\begin{itemize}
\item \textsl{Single and Multivariable Calculus: Early
  Transcendentals}. Guichard. Copyright \copyright\ 2015 Guichard,
  Creative Commons Attribution-NonCommercial-ShareAlike License 3.0.
  \url{http://communitycalculus.org}
\item \textsl{APEX Calculus}. Hartman, Heinold, Siemers, Chalishajar,
  Bowen (Ed.). Copyright \copyright\ 2014 Hartman, Creative Commons Attribution-Noncommercial 3.0. \url{http://www.apexcalculus.com/}
\item \textsl{Elementary Calculus: An Infinitesimal
  Approach}. Keisler. Copyright \copyright\ 2015 Keisler, Creative
  Commons Attribution-NonCommercial-ShareAlike License 3.0.
  \url{http://www.math.wisc.edu/~keisler/calc.html}
\end{itemize}

\noindent This book is typeset in the STIX and Gillius fonts.



\noindent We will be glad to receive corrections and suggestions for
improvement at: \texttt{ximera@math.osu.edu}

\twocolumn
\clearpage
\ifnotoc\else % When notoc option is used, we do not include a table of contents.  Otherwise:
	\tableofcontents\clearpage % we include a table of contents in every course packet.  
	\clearpage
        \fi
\pagestyle{main} %switch to main pagestyle, just like ximera documents.
\let\maketitle\othermaketitle % renew maketitle to usual definition.
}
\makeatother







%% Two column sep
\setlength{\columnsep}{1cm}
%\setlength{\columnseprule}{.8cm}
%\renewcommand{\columnseprulecolor}{white!20!black}


%% image environment
%%\renewenvironment{image}[1][]{\begin{center}}{\end{center}}
\let\image\relax
\let\endimage\relax
\NewEnviron{image}[1][3in]{% 
  \begin{center}\resizebox{#1}{!}{\BODY}\end{center}% resize and center
}

%% This is the code that will allow us to redefine the title with
\makeatletter
\renewcommand\chapterstyle{%
  \def\maketitle{%
    \addtocounter{titlenumber}{1}%
    \phantomsection
    \addcontentsline{toc}{section}{\textbf{\thetitlenumber\hspace{1em}\@title}}%
                    {\flushleft\small\sffamily\bfseries\@pretitle\par\vspace{-1.5em}}%
                    {\flushleft\LARGE\sffamily\bfseries\thetitlenumber\hspace{1em}\@title \par }%
                    {\setcounter{problem}{0}\setcounter{sectiontitlenumber}{0}}%
                    \par}}

\renewcommand\sectionstyle{%
  \def\maketitle{%
    \addtocounter{sectiontitlenumber}{1}
    \phantomsection
    \addcontentsline{toc}{subsection}{\thetitlenumber.\thesectiontitlenumber\hspace{1em}\@title}%
    {\flushleft\small\sffamily\bfseries\@pretitle\par\vspace{-1.5em}}%
    {\flushleft\Large\sffamily\bfseries\thetitlenumber.\thesectiontitlenumber\hspace{1em}\@title \par}%
    \par}}

%% redefine Part
\renewcommand\part{%
  \if@openright
    \cleardoublepage
  \else
    \clearpage
  \fi
  \thispagestyle{plain}%
  \if@twocolumn
    \onecolumn
    \@tempswatrue
  \else
    \@tempswafalse
  \fi
  \null\vfil
  \secdef\@part\@spart}

\def\@part[#1]#2{%
    \ifnum \c@secnumdepth >-2\relax
      \refstepcounter{part}%
      \addcontentsline{toc}{part}{\thepart\hspace{1em}#1}%
    \else
      \addcontentsline{toc}{part}{#1}%
    \fi
    \markboth{}{}%
    {\centering
     \interlinepenalty \@M
     \normalfont
     \ifnum \c@secnumdepth >-2\relax
       \huge\sffamily\bfseries \partname\nobreakspace\thepart
       \par
       \vskip 20\p@
     \fi
     \Huge \bfseries #2\par}%
    \@endpart}
\def\@spart#1{%
    {\centering
     \interlinepenalty \@M
     \normalfont
     \Huge \bfseries #1\par}%
    \@endpart}
\def\@endpart{\vfil\newpage
              \if@twoside
               \if@openright
                \null
                \thispagestyle{empty}%
                \newpage
               \fi
              \fi
              \if@tempswa
                \twocolumn
                \fi}


\renewcommand\section{\@startsection{paragraph}{10}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\normalfont\large\sffamily\bfseries}}
\renewcommand\subsection{\@startsection{subparagraph}{10}{\z@}%
                                    {3.25ex \@plus1ex \@minus.2ex}%
                                    {-1em}%
                                    {\normalfont\normalsize\sffamily\bfseries}}


% remove italics def
\let\definition\relax
\let\enddefinition\relax
\theoremstyle{definition}
\newtheorem*{definition}{Definition}


% remove italics def
\let\exploration\relax
\let\endexploration\relax
\theoremstyle{definition}
\newtheorem*{exploration}{Exploration}


% remove italics def
\let\remark\relax
\let\endremark\relax
\theoremstyle{definition}
\newtheorem*{remark}{Remark}

\let\procedure\relax
\let\endprocedure\relax
\theoremstyle{definition}
\newtheorem*{procedure}{Procedure}


\let\theorem\relax
\let\endtheorem\relax
\let\c@theorem\relax 
\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}

\let\question\relax
\let\endquestion\relax
\let\c@question\relax 
\theoremstyle{theorem}
\newtheorem{question}{Question}

\let\problem\relax
\let\endproblem\relax
\let\c@problem\relax 
\newtheorem{problem}{Problem}


\let\warning\relax
\let\endwarning\relax
\newtheorem*{warning}{Warning}
\makeatother

%% Redefines "explanation"
\renewmdenv[
  font=\upshape,
  outerlinewidth=3,
  topline=false,
  bottomline=false,
  leftline=true,
  rightline=false, 
  leftmargin=0,
  innertopmargin=0pt,
  innerbottommargin=0pt,
  skipbelow=\baselineskip,
  linecolor=textColor!20!white,
  fontcolor=textColor,
  backgroundcolor=background
]{explanation}%


%% Compress dialogue
\renewenvironment{dialogue}{%
   \renewcommand\descriptionlabel[1]{\hspace{\labelsep}\textbf{##1:}}
   \small\begin{description}[noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt]%
}{%
   \end{description}\normalsize%
}


%% Fix weird index issue.
\makeatletter
\gdef\ttl@savemark{\sectionmark{}}
\makeatother

%% Fix greek
\renewcommand{\epsilon}{\varepsilon}
\renewcommand{\phi}{\varphi}


\endinput
