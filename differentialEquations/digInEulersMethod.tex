\documentclass{ximera}

\input{../preamble.tex}

\outcome{}

\title[Dig-In:]{Euler's method}

\begin{document}
\begin{abstract}
Stuff
\end{abstract}
\maketitle

\section{Formulas or none}

In science and mathematics, it is often easier to setup a differential
equation than it is to solve it. In this case, a numerical
solution is often ``good enough.''

Suppose you have set up the following differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
While one can solve this differential equation, we cannot solve it
\textit{yet}. Supposing we needed a solution, we could try to find a
numerical solution using Euler's Method.

\[
\begin{tchart}{lll}
n & x_n & y_n \\ \hline
0 & 1   & 3.8 \\
1 & 1.2 & 3.73\\
2 & 1.4 & 3.63\\
3 & 1.6 & 3.51\\
4 & 1.8 & 3.37\\
5 & 2 & 3.19\\
6 & 2.2   & 3.00 \\
7 & 2.4 & 2.80\\
8 & 2.6 & 2.61\\
9 & 2.8 & 2.44\\
10 & 3 & 2.30
\end{tchart}
\]
Variation of Euler's Method for the differential equation
$f'(x) = \left(f(x)\right)^2 - 6f(x) + 8$ with initial condition
$f(1) = 3.8$.
%% \label{table:diffeuler1}



\begin{example}\label{example:slopefield1}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 3.8$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(3)$. 

\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            xmin=1, xmax=3,ymin=0,ymax=5,
            axis lines =center, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            xtick={1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3},
            axis on top,
          ]         
	  \addplot [penColor2, very thick] plot coordinates {
            (1,3.8) (1.2,3.73) (1.4,3.63) (1.6,3.51) (1.8,3.37) (2,3.19)
            (2.2,3) (2.4,2.80) (2.6,2.61) (2.8,2.44) (3,2.30)
          };
          \node at (axis cs:.3,2) [penColor] {$f(x)$};          
        \end{axis}
\end{tikzpicture}
%% \caption{Here we see our polygonal curve found via Euler's Method
%%   based on the differential equation $f'(x) = \left(f(x)\right)^2 -
%%   6f(x) + 8$, with initial value $f(1) =3.8$.  Choosing a smaller
%%   step-size $h$ would yield a better approximation.}
%% \label{figure:eulerDiffEQ}
\end{image}

\begin{explanation}
To solve this problem we'll use a variation on Euler's Method. We'll
make a table following this format
\[
\begin{tchart}{lll}
n & x_n     & y_n \\ \hline
0 & x_0     & y_0 \\
1 & x_0 + h & y_0+h\cdot \left(y_0^2-6y_0+8\right)\\
2 & x_1 + h & y_1+h\cdot \left(y_1^2-6y_1+8\right)\\
3 & x_2 + h & y_2+h\cdot \left(y_2^2-6y_2+8\right)\\
4 & x_3 + h & y_3+h\cdot \left(y_3^2-6y_3+8\right)\\
  \hdotsfor{3}
\end{tchart}
\]
At each step, we are simply making a linear approximation to
$f(x)$. Filling out this table, we produce
Table~\ref{table:diffeuler1}.  Hence our estimate for $f(3)$ is
$2.30$, see Figure~\ref{figure:eulerDiffEQ}.
\end{explanation}
\end{example}


Let's try this example again with a different initial condition.


\begin{example}\label{example:slopefield2}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 4$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(3)$. 

\begin{explanation}
Again we'll use a variation on Euler's Method. Making the table as we
did before, see Table~\ref{table:diffeuler2}.  This time our solution
is simply the function $f(x) = 4$. Note, this does solve the
differential equation as, given
\begin{align*}
f'(x) &= \left(f(x)\right)^2 - 6f(x) + 8\\
0 &= \left(4\right)^2 - 6\cdot4 + 8.
\end{align*}
\end{explanation}
\end{example}

\[
\begin{tchart}{lll}
n & x_n & y_n \\ \hline
0 & 1   & 4 \\
1 & 1.2 & 4\\
2 & 1.4 & 4\\
3 & 1.6 & 4\\
4 & 1.8 & 4\\
5 & 2 & 4\\
6 & 2.2 & 4 \\
7 & 2.4 & 4\\
8 & 2.6 & 4\\
9 & 2.8 & 4\\
10 & 3 & 4
\end{tchart}
\]
Variation of Euler's Method for the differential equation
  $f'(x) = \left(f(x)\right)^2 - 6f(x) + 8$ with initial condition
  $f(1) = 4$.
%\label{table:diffeuler2}


Finally, we'll try do the same example again with another initial
condition.

\[
\begin{tchart}{lll}
n & x_n & y_n \\ \hline
0 & 1   & 2 \\
1 & 1.2 & 2\\
2 & 1.4 & 2\\
3 & 1.6 & 2\\
4 & 1.8 & 2\\
5 & 2 & 2\\
6 & 2.2 & 2 \\
7 & 2.4 & 2\\
8 & 2.6 & 2\\
9 & 2.8 & 2\\
10 & 3 & 2
\end{tchart}
\]
Variation of Euler's Method for the differential equation
  $f'(x) = \left(f(x)\right)^2 - 6f(x) + 8$ with initial condition
  $f(1) = 2$.
%\label{table:diffeuler3}


\begin{example}\label{example:slopefield3}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 2$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(3)$. 

\begin{explanation}
Using the same variation on Euler's Method as before, see
Table~\ref{table:diffeuler3}.  This time our solution is simply the
function $f(x) = 2$. Note, this does solve the differential equation
as, given
\begin{align*}
f'(x) &= \left(f(x)\right)^2 - 6f(x) + 8\\
0 &= \left(2\right)^2 - 6\cdot2 + 8.
\end{align*}
\end{explanation}
\end{example}


From our examples above, we see that certain differential equations
can have very different solutions based on initial conditions. To
really see what is happening here, we should look at a \textit{slope
  field}.\index{slope field}

%\begin{procedureForConstructingASlopeField}
It is usually easiest to construct a slope field using a computer
algebra system. Nevertheless, the general theory of constructing a
slope field must be understood before one can do this.  Suppose you
have a differential equation relating $f(x)$ and $f'(x)$.
\begin{itemize}
\item Choose a value for $dx$, this will be your step-size.
\item Plot points on an $(x,y)$-plane in increments of size $dx$. 
\item For each point plotted, assume this point is on the curve $f(x)$. 
\item Now use your differential equation to plot an arrow pointing in
  the direction of $(dx,dy)$ from the given point, where $dy =
  f'(x)dx$. This means one draws an arrow in the same direction as the
  arrow from $(x,y)$ to $(x + dx, y + dy)$.
\end{itemize}
%\end{procedureForConstructingASlopeField}

Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
if the step-size is $dx =1$, and we are at the point $(3,1)$ then we
should plot an arrow in the same direction as the arrow whose tail is
at $(3,1)$ and whose tip is at
\begin{align*}
(3+1,1 + f'(1))  &= (4, 1 +1 -6+8)\\
&= (4,4).
\end{align*}
Let's examine the slope field for $f(x)$:

{\def\length{sqrt(1+(y^2-6*y+8)^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=0, xmax=5,ymin=0,ymax=5,domain=0:5,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={(y^2 -6*y + 8)/(\length)},scale arrows=.2},-stealth,samples=20] {0};
  \end{axis}
\end{tikzpicture}}

Every solution to the differential equation should follow the arrows
in the slope field.  Compare this slope field to the solutions found
in Example~\ref{example:slopefield1},
Example~\ref{example:slopefield2}, and
Example~\ref{example:slopefield3}. The slope field allows us to
examine each solution of the given differential equation
simultaneously---this often gives more insight into a problem than a
single solution.


\end{document}
