\chapter{Antiderivatives}

\section{Basic Antiderivatives}

Computing derivatives is not too difficult. At this point, you should
be able to take the derivative of almost any function you can write
down. However, undoing derivatives is much harder. This process of
undoing a derivative is called taking an \textit{antiderivative}.

\begin{definition}\index{antiderivative}
A function $F(x)$ is called an \textbf{antiderivative} of $f(x)$ on an
interval if
\[
F'(x) = f(x)
\]
for all $x$ in the interval.
\end{definition}

We have special notation for the antiderivative:

\begin{definition}\index{antiderivative!notation}\index{indefinite integral}
The antiderivative is denoted by
\[
\int f(x) \d x = F(x)+C,
\]
where $dx$ identifies $x$ as the variable and $C$ is a constant
indicating that there are many possible antiderivatives, each varying by
the addition of a constant.  This is often called the
\textbf{indefinite integral}.
\end{definition}

Here are the basic antiderivatives. Note each of these examples comes
directly from our knowledge of basic derivatives.


\begin{fullwidth}
\begin{mainTheorem}[Basic Antiderivatives]\label{theorem:basicAnti} \hfil
\begin{multicols}{3}
\begin{itemize}
\item $\int k \d x= kx+C$.
\item $\int x^n \d x= \frac{x^{n+1}}{n+1}+C\qquad(n\ne-1)$.
\item $\int e^x \d x= e^x + C$.
\item $\int a^x \d x= \frac{a^x}{\ln(a)}+C$.
\item $\int \frac{1}{x} \d x= \ln|x|+C$.
\item $\int \cos(x) \d x = \sin(x) + C$.
\item $\int \sin(x) \d x = -\cos(x) + C$.  
\item $\int \tan(x) \d x = -\ln|\cos(x)| + C$.  
\item $\int \sec^2(x) \d x = \tan(x) + C$. 
\item $\int \csc^2(x) \d x = -\cot(x) + C$.
\item $\int \sec(x)\tan(x) \d x = \sec(x) + C$.
\item $\int \csc(x)\cot(x) \d x = -\csc(x) + C$.
\item $\int \frac{1}{x^2+1}\d x = \arctan(x) + C$.
\item $\int \frac{1}{\sqrt{1-x^2}}\d x= \arcsin(x)+C$.
\end{itemize}
\end{multicols}
\end{mainTheorem}
\end{fullwidth}
It may seem that one could simply memorize these antiderivatives and
antidifferentiating would be as easy as differentiating. This is
\textbf{not} the case. The issue comes up when trying to combine these
functions.  When taking derivatives we have the \textit{product rule}
and the \textit{chain rule}. The analogues of these two rules are much
more difficult to deal with when taking antiderivatives. However, not
all is lost. We have the following analogue of the Sum Rule for
derivatives, Theorem~\ref{theorem:sum rule}.

\begin{mainTheorem}[The Sum Rule for Antiderivatives]\label{theorem:SRA}
Given two functions $f(x)$ and $g(x)$ where $k$ is a constant:
\begin{itemize}
\item $\int k f(x) \d x= kF(x) + C$.
\item $\int \left(f(x) + g(x)\right) \d x = F(x) + G(x) + C$.
\end{itemize}
\end{mainTheorem}

Let's put this rule and our knowledge of basic derivatives to work.

\begin{example}
Compute
\[
\int 3 x^7 \d x.
\]
\end{example}

\begin{solution}
By Theorem~\ref{theorem:basicAnti} and Theorem~\ref{theorem:SRA}, we
see that
\begin{align*}
\int 3 x^7 \d x &= 3 \int x^7 \d x\\
&= 3 \cdot \frac{x^8}{8}+C.
\end{align*}
\end{solution}

The sum rule for antiderivatives, Theorem~\ref{theorem:SRA}, allows us to integrate term-by-term. Let's see an example of this.

\begin{example}
Compute
\[
\int \left(x^4 + 5x^2 - \cos(x)\right) \d x.
\]
\end{example}

\begin{solution} 
Let's start by simplifying the problem using the sum rule for
antiderivatives, Theorem~\ref{theorem:SRA}.
\[
\int \left(x^4 + 5x^2 - \cos(x)\right) \d x = \int x^4 \d x + 5\int x^2 \d x - \int \cos(x) \d x.
\]
Now we may integrate term-by-term to find
\[
\int \left(x^4 + 5x^2 - \cos(x)\right) \d x = \frac{x^5}{5} + \frac{5x^3}{3}  - \sin(x)+C.
\]
\end{solution}


\begin{warning}
While the sum rule for antiderivatives allows us to integrate
term-by-term, we cannot integrate \textit{factor-by-factor}, meaning
that in general
\[
\int f(x)g(x) \d x \ne \int f(x) \d x\cdot \int g(x) \d x.
\]
\end{warning}








\subsection*{Tips for Guessing Antiderivatives}


Unfortunately, we cannot tell you how to compute every antiderivative.
We advise that the mathematician view antiderivatives as a sort of
\textit{puzzle}. Later we will learn a hand-full of techniques for
computing antiderivatives. However, a robust and simple way to compute
antiderivatives is guess-and-check.


\begin{guessingAntiderivatives}\hfil
\begin{enumerate}
\item Make a guess for the antiderivative.
\item Take the derivative of your guess.
\item Note how the above derivative is different from the function
  whose antiderivative you want to find.
\item Change your original guess by \textbf{multiplying} by constants
  or by \textbf{adding} in new functions.
\end{enumerate}
\end{guessingAntiderivatives}

\begin{template}\label{template:powerchain}
If the indefinite integral looks \emph{something} like
\[
\int \mathrm{stuff}' \cdot (\mathrm{stuff})^n \d x \qquad\text{then guess} \qquad \mathrm{stuff}^{n+1}
\]
where $n\ne -1$.
\end{template}

\begin{example} Compute
\[
\int \frac{x^3}{\sqrt{x^4 -6}} \d x.
\]
\end{example}

\begin{solution}
Start by rewriting the indefinite integral as
\[
\int x^3\left(x^4 -6\right)^{-1/2} \d x.
\]
Now start with a guess of 
\[
\int x^3\left(x^4 -6\right)^{-1/2} \d x \approx \left(x^4 -6\right)^{1/2}.
\]
Take the derivative of your guess to see if it is correct:
\[
\ddx  \left(x^4 -6\right)^{1/2} = (4/2)x^3\left(x^4 -6\right)^{-1/2}.
\]
We're off by a factor of $2/4$, so multiply our guess by this constant
to get the solution,
\[
\int \frac{x^3}{\sqrt{x^4 -6}} \d x = (2/4)\left(x^4 -6\right)^{1/2}+C.
\]
\end{solution}


\begin{template}\label{template:echain}
If the indefinite integral looks \emph{something} like
\[
\int \mathrm{junk}\cdot e^{\mathrm{stuff}} \d x \qquad\text{then
  guess}\qquad e^{\mathrm{stuff}} \text{ \textbf{or} }\mathrm{junk}
\cdot e^{\mathrm{stuff}}.
\]
\end{template}


\begin{example}
Compute
\[
\int xe^{x} \d x.
\]
\end{example}


\begin{solution}
We try to guess the antiderivative. Start with a guess of
\[
\int xe^x \d x \approx xe^x.
\]
Take the derivative of your guess to see if it is correct:
\[
\ddx xe^x = e^x + xe^x.
\]
Ah! So we need only subtract $e^x$ from our original guess.  We now
find
\[
\int xe^x \d x =xe^x - e^x + C.
\]
\end{solution}





\begin{template}\label{template:lnchain}
If the indefinite integral looks \emph{something} like
\[
\int \frac{\mathrm{stuff}'}{\mathrm{stuff}}\d x \qquad\text{then guess}\qquad\ln(\mathrm{stuff}).
\]
\end{template}

\begin{example}
Compute
\[
\int \frac{2x^2}{7x^3 + 3} \d x.
\]
\end{example}

\begin{solution} We'll start with a guess of
\[
\int \frac{2x^2}{7x^3 + 3} \d x \approx \ln(7x^3+3).
\]
Take the derivative of your guess to see if it is correct:
\[
\ddx \ln(7x^3+3) = \frac{21x^2}{7x^3 + 3}.
\]
We are only off by a factor of $2/21$, so we need to multiply our
original guess by this constant to get the solution,
\[
\int \frac{2x^2}{7x^3 + 3} \d x = (2/21)\ln(7x^3+3)+C.
\]
\end{solution}




\begin{template}\label{template:trigchain}
If the indefinite integral looks \emph{something} like
\[
\int \mathrm{junk}\cdot \sin(\mathrm{stuff}) \d x \qquad\text{then
  guess}\qquad \cos(\mathrm{stuff}) \text{ \textbf{or} }\mathrm{junk}
\cdot \cos(\mathrm{stuff}),
\]
likewise if you have 
\[
\int \mathrm{junk}\cdot \cos(\mathrm{stuff}) \d x \qquad\text{then
  guess}\qquad \sin(\mathrm{stuff}) \text{ \textbf{or} }\mathrm{junk}
\cdot \sin(\mathrm{stuff}),
\]
\end{template}



\begin{example}
Compute
\[
\int x^4\sin(3x^5+7) \d x.
\]
\end{example}


\begin{solution}
Here we simply try to guess the antiderivative. Start with a guess of
\[
\int x^4\sin(3x^5+7)\d x \approx \cos(3x^5+7).
\]
To see if your guess is correct, take the derivative of $\cos(3x^5+7)$,
\[
\ddx \cos(3x^5+7) = -15x^4\sin(3x^5+7).
\]
We are off by a factor of $-1/15$. Hence we should multiply our
original guess by this constant to find
\[
\int x^4\sin(3x^5+7) \d x = \frac{-\cos(3x^5+7)}{15} + C.
\]
\end{solution}





\subsection*{Final Thoughts}
Computing antiderivatives is a place where insight and rote
computation meet. We cannot teach you a method that will always
work. Moreover, merely \emph{understanding} the examples above will
probably not be enough for you to become proficient in computing
antiderivatives. You must practice, practice, practice!



\begin{exercises}
\noindent Compute the following antiderivatives.
\begin{multicols}{2}
\begin{exercise}
$\int 5\d x$
\begin{answer}
$5x+C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \left(-7x^4+8\right)\d x$
\begin{answer}
$-7x^5/5 +8x + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \left(2e^x -4\right)\d x$
\begin{answer}
$2e^x -4x + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \left(7^x - x^7\right)\d x$
\begin{answer}
$7^x/\ln(7) - x^8/8 +C$
\end{answer}
\end{exercise}


\begin{exercise}
$\int \left(\frac{15}{x}+x^{15}\right)\d x$
\begin{answer}
$15\ln|x| + x^{16}/16 + C$
\end{answer}
\end{exercise}


\begin{exercise}
$\int \left(-3\sin(x) + \tan(x)\right)\d x$
\begin{answer}
$3\cos(x) -\ln|\cos(x)|+C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \left(\sec^2(x) -\csc^2(x)\right) \d x$
\begin{answer}
$\tan(x) + \cot(x) + C$
\end{answer}
\end{exercise}


\begin{exercise}
$\int\left(\frac{1}{x} + \frac{1}{x^2} + \frac{1}{\sqrt{x}}\right)\d x$
\begin{answer}
$\ln|x|  - x^{-1} + 2\sqrt{x} +C$ 
\end{answer}
\end{exercise}

\begin{exercise}
$\int\left(\frac{17}{1 + x^2} +\frac{13}{x}\right)\d x$
\begin{answer}
$17\arctan(x) + 13\ln|x| +C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int\left(\frac{\csc(x)\cot(x)}{4} - \frac{4}{\sqrt{1-x^2}}\right)\d x$
\begin{answer}
$-\csc(x)/4 - 4\arcsin(x) + C$
\end{answer}
\end{exercise}

\end{multicols}



\noindent Use Template~\ref{template:powerchain} to compute the
following antiderivatives:
\begin{multicols}{2}
\begin{exercise}
$\int 2x (x^2+4)^5 \d x$
\begin{answer}
$(x^2+4)^6/6 + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \frac{(\ln(x))^4}{x} \d x$ 
\begin{answer}
$(\ln(x))^5/5 +C$
\end{answer}
\end{exercise}


\begin{exercise}
$\int \frac{1}{\sqrt{2x +1}} \d x$ 
\begin{answer}
$\sqrt{2x+1} + C$
\end{answer}
\end{exercise}

\columnbreak

\begin{exercise}
$\int \frac{x}{\sqrt{x^2+1}} \d x$
\begin{answer}
$\sqrt{x^2+1} + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int x\sqrt{4-x^2} \d x$
\begin{answer}
$-(4-x^2)^{3/2}/3 +C$
\end{answer}
\end{exercise}


\begin{exercise}
$\int \frac{\sqrt{\ln(x)}}{x} \d x$ 
\begin{answer}
$2(\ln(x))^{3/2}/3 +C$
\end{answer}
\end{exercise}
\end{multicols}

\noindent Use Template~\ref{template:echain} to compute the following
antiderivatives:

\begin{multicols}{2}
\begin{exercise}
$\int 3x^2 e^{x^3-1} \d x$ 
\begin{answer}
$e^{x^3-1} + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int x e^{3(x^2)} \d x$ 
\begin{answer}
$e^{3(x^2)}/6+C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int 2x e^{-(x^2)} \d x$ 
\begin{answer}
$-e^{-(x^2)} + C$
\end{answer}
\end{exercise}

\columnbreak

\begin{exercise}
$\int \frac{8x}{e^{(x^2)}}\d x$ 
\begin{answer}
$-4e^{-(x^2)} +C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int x e^{5x} \d x$ 
\begin{answer}
$xe^{5x}/5 - e^{5x}/25 + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int x e^{-x/2} \d x$ 
\begin{answer}
$-4e^{-x/2}  - 2xe^{-x/2} +C$
\end{answer}
\end{exercise}
\end{multicols}

\noindent Use Template~\ref{template:lnchain} to compute the following
antiderivatives:

\begin{multicols}{2}
\begin{exercise}
$\int \frac{1}{2x} \d x$
\begin{answer}
$\ln(2x)/2 + C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \frac{x^4}{x^5+1} \d x$
\begin{answer}
$\ln(x^5+1)/5 +C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \frac{x^2}{3-x^3} \d x$  
\begin{answer}
$-\ln(3-x^3)/3+C$
\end{answer}
\end{exercise}

\columnbreak

\begin{exercise}
$\int \frac{1}{x\ln(x)} \d x$ 
\begin{answer}
$\ln(\ln(x))+C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \frac{e^{2x}-e^{-2x}}{e^{2x}+e^{-2x}} \d x$ 
\begin{answer}
$\ln(e^{2x}+e^{-2x})/2 +C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \frac{1}{x\ln(x^2)} \d x$ 
\begin{answer}
$\ln(\ln(x^2))/2 + C$
\end{answer}
\end{exercise}
\end{multicols}


\noindent Use Template~\ref{template:trigchain} to compute the
following antiderivatives:


\begin{multicols}{2}
\begin{exercise}
$\int 5x^4 \sin(x^5+3) \d x$ 
\begin{answer}
$-\cos(x^5+3) +C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int x \cos(-2x^2) \d x$
\begin{answer}
$-\sin(-2x^2)/4 +C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int x \sin(5x^2) \d x$
\begin{answer}
$-\cos(5x^2)/10 +C$
\end{answer}
\end{exercise}

\columnbreak

\begin{exercise}
$\int 8x\cos(x^2)\d x$       
\begin{answer}
$4\sin(x^2)+C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int 6e^{3x} \sin(e^{3x}) \d x$   
\begin{answer}
$-2\cos(e^{3x})+C$
\end{answer}
\end{exercise}

\begin{exercise}
$\int \frac{\cos(\ln(x))}{x} \d x$ 
\begin{answer}
$\sin(\ln(x)) + C$
\end{answer}
\end{exercise}
\end{multicols}
\end{exercises}















\section{Differential Equations}

A \textit{differential equation}\index{differential equation} is
simply an equation with a derivative in it like this:
\[
f'(x) = k f(x).
\]
When a mathematician solves a differential equation, they are finding
a \textit{function} that satisfies the equation.

\subsection*{Falling Objects}

Recall that the acceleration due to gravity is about $-9.8$
m/s$^2$. Since the first derivative of the function giving the
velocity of an object gives the acceleration of the object and the
second derivative of a function giving the position of a falling
object gives the acceleration, we have the differential equations
\begin{align*}
v'(t) &=  -9.8,\\
p''(t) &=  -9.8.
\end{align*}
From these simple equation, we can derive equations for the velocity of
the object and for the position using antiderivatives.


\begin{example}
A ball is tossed into the air with an initial velocity of $15$
m/s. What is the velocity of the ball after 1 second? How about after
2 seconds?
\end{example}

\begin{solution}
Knowing that the acceleration due to gravity is $-9.8$ m/s$^2$, we write
\[
v'(t) = -9.8.
\]
To solve this differential equation, take the antiderivative of both sides
\begin{align*}
\int v'(t) \d t &= \int -9.8 \d t\\
v(t) &= -9.8t + C.
\end{align*}
Here $C$ represents the initial velocity of the ball. Since it is
tossed up with an initial velocity of $15$ m/s, 
\[
15 = v(0) = -9.8\cdot 0 + C,
\]
and we see that $C=15$. Hence $v(t) = -9.8t + 15$. Now $v(1) = 5.2$
m/s, the ball is rising, and $v(2) = -4.6$ m/s, the ball is falling.
\end{solution}

Now let's do a similar problem, but instead of finding the velocity,
we will find the position.

\begin{example}
A ball is tossed into the air with an initial velocity of $15$ m/s
from a height of 2 meters. When does the ball hit the ground?
\end{example}

\begin{solution}
Knowing that the acceleration due to gravity is $-9.8$ m/s$^2$, we write
\[
p''(t) = -9.8.
\]
Start by taking the antiderivative of both sides of the equation
\begin{align*}
\int p''(t) \d t &= \int -9.8 \d t\\
p'(t) &= -9.8t + C.
\end{align*}
Here $C$ represents the initial velocity of the ball. Since it is
tossed up with an initial velocity of $15$ m/s, $C = 15$ and 
\[
p'(t) = -9.8t + 15.
\]
Now let's take the antiderivative again. 
\begin{align*}
\int p'(t) \d t &= \int -9.8t +15\d t\\
p(t) &= \frac{-9.8t^2}{2} + 15t + D.
\end{align*}
Since we know the initial height was $2$ meters, write
\[
2 = p(0) =  \frac{-9.8\cdot 0^2}{2} + 15\cdot 0 + D.
\]
Hence $p(t) = \frac{-9.8t^2}{2} + 15t + 2$. We need to know when the
ball hits the ground, this is when $p(t)=0$. Solving the equation
\[
\frac{-9.8t^2}{2} + 15t + 2 = 0
\]
we find two solutions $t\approx -0.1$ and $t\approx 3.2$. Discarding
the negative solution, we see the ball will hit the ground after
approximately $3.2$ seconds.
\end{solution}


The power of calculus is that it frees us from rote memorization of
formulas and enables us to derive what we need.



\subsection*{Exponential Growth and Decay}

A function $f(x)$ exhibits \textit{exponential
  growth}\index{exponential growth} if its growth rate is proportional
to its value. As a differential equation, this means
\[
f'(x) = k f(x)\qquad\text{for some constant of proportionality $k$.}
\]
We claim that this differential equation is solved by $f(x) = A
e^{kx}$, where $A$ and $k$ are constants.  Check it out, if $f(x) =
Ae^{kx}$, then
\begin{align*}
f'(x) &= Ak e^{kx}\\
&= k\left(Ae^{kx} \right)\\
&= k f(x).
\end{align*}

\begin{example}
A culture of yeast starts with 100 cells. After 160 minutes, there
are 350 cells. Assuming that the growth rate of the yeast is
proportional to the number of yeast cells present, estimate when the
culture will have 1000 cells.
\end{example}

\begin{solution}
Since the growth rate of the yeast is proportional to the number of
yeast cells present, we have the following differential equation
\[
p'(t) = k p(t)
\]
where $p(t)$ is the population of the yeast culture and $t$ is time
measured in minutes. We know that this differential equation is solved
by the function
\[
p(t) = A e^{kt}
\]
where $A$ and $k$ are yet to be determined constants. Since
\[
100 = p(0) = Ae^{k\cdot 0}
\]
we see that $A = 100$. So 
\[
p(t) = 100 e^{kt}.
\]
Now we must find $k$. Since we know that 
\[
350 = p(160) = 100e^{k\cdot 160}
\]
we need to solve for $k$. Write
\begin{align*}
350 &= 100 e^{k\cdot 160}\\
3.5 &= e^{k\cdot 160}\\
\ln(3.5) &= k\cdot 160\\
\ln(3.5)/160 &= k. 
\end{align*}
Hence
\[
p(t) = 100 e^{t\ln(3.5)/160} = 100 \cdot 3.5^{t/160}.
\]
To find out when the culture has 1000 cells, write
\begin{align*}
1000 &= 100 \cdot 3.5^{t/160}\\
10 &= 3.5^{t/160}\\
\ln(10) &= \frac{t\ln(3.5)}{160}\\
\frac{160\ln(10)}{\ln(3.5)} &= t.
\end{align*}
From this we find that after approximately $294$ minutes, there are
around $1000$ yeast cells present.
\end{solution}


It is worth seeing an example of exponential decay as well. Consider
this: Living tissue contains two types of carbon, a stable
isotope carbon-12 and a radioactive (unstable) isotope
carbon-14. While an organism is alive, the ratio of one isotope of
carbon to the other is always constant. When the organism dies, the
ratio changes as the radioactive isotope decays. This is the basis of
radiocarbon dating.


\begin{example}
The half-life of carbon-14 (the time it takes for half of an amount of
carbon-14 to decay) is about 5730 years. If the rate of decay is
proportional to the amount of carbon-14, and if we found a bone with
$1/70$th of the amount of carbon-14 we would expect to find in a living
organism, approximately how old is the bone?
\end{example}

\begin{solution}
Since the rate of decay of carbon-14 is proportional to the amount of
carbon-14 present, we can model this situation with the differential
equation
\[
f'(t) = k f(t).
\]
We know that this differential equation is solved by the function
defined by
\[
f(t) = A e^{kt}
\]
where $A$ and $k$ are yet to be determined constants. Since the
half-life of carbon-14 is about $5730$ years we write
\[
\frac{1}{2} = e^{k 5730}.
\]
Solving this equation for $k$, gives
\[
k = \frac{-\ln(2)}{5730}.
\]
Since we currently have $1/70$th of the original amount of carbon-14
we write
\[
\frac{1}{70} = 1\cdot e^{\frac{-\ln(2)t}{5730}}.
\]
Solving this equation for $t$, we find $t \approx -35121$. This means
that the bone is approximately $35121$ years old.
\end{solution}


\subsection*{Formulas or None}

In science and mathematics, it is often easier to setup a differential
equation than it is to solve it. In this case, a numerical
solution is often ``good enough.''

Suppose you have set up the following differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
While one can solve this differential equation, we cannot solve it
\textit{yet}. Supposing we needed a solution, we could try to find a
numerical solution using Euler's Method.

\begin{margintable}[-1in]
\[
\begin{tchart}{lll}
n & x_n & y_n \\ \hline
0 & 1   & 3.8 \\
1 & 1.2 & 3.73\\
2 & 1.4 & 3.63\\
3 & 1.6 & 3.51\\
4 & 1.8 & 3.37\\
5 & 2 & 3.19\\
6 & 2.2   & 3.00 \\
7 & 2.4 & 2.80\\
8 & 2.6 & 2.61\\
9 & 2.8 & 2.44\\
10 & 3 & 2.30
\end{tchart}
\]
\caption{Variation of Euler's Method for the differential equation
  $f'(x) = \left(f(x)\right)^2 - 6f(x) + 8$ with initial condition
  $f(1) = 3.8$.}
\label{table:diffeuler1}
\end{margintable}


\begin{example}\label{example:slopefield1}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 3.8$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(3)$. 
\end{example}


\begin{marginfigure}[0in]
\begin{tikzpicture}
	\begin{axis}[
            xmin=1, xmax=3,ymin=0,ymax=5,
            axis lines =center, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            xtick={1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3},
            axis on top,
          ]         
	  \addplot [penColor2, very thick] plot coordinates {
            (1,3.8) (1.2,3.73) (1.4,3.63) (1.6,3.51) (1.8,3.37) (2,3.19)
            (2.2,3) (2.4,2.80) (2.6,2.61) (2.8,2.44) (3,2.30)
          };
          \node at (axis cs:.3,2) [penColor] {$f(x)$};          
        \end{axis}
\end{tikzpicture}
\caption{Here we see our polygonal curve found via Euler's Method
  based on the differential equation $f'(x) = \left(f(x)\right)^2 -
  6f(x) + 8$, with initial value $f(1) =3.8$.  Choosing a smaller
  step-size $h$ would yield a better approximation.}
\label{figure:eulerDiffEQ}
\end{marginfigure}

\begin{solution}
To solve this problem we'll use a variation on Euler's Method. We'll
make a table following this format
\[
\begin{tchart}{lll}
n & x_n     & y_n \\ \hline
0 & x_0     & y_0 \\
1 & x_0 + h & y_0+h\cdot \left(y_0^2-6y_0+8\right)\\
2 & x_1 + h & y_1+h\cdot \left(y_1^2-6y_1+8\right)\\
3 & x_2 + h & y_2+h\cdot \left(y_2^2-6y_2+8\right)\\
4 & x_3 + h & y_3+h\cdot \left(y_3^2-6y_3+8\right)\\
  \hdotsfor{3}
\end{tchart}
\]
At each step, we are simply making a linear approximation to
$f(x)$. Filling out this table, we produce
Table~\ref{table:diffeuler1}.  Hence our estimate for $f(3)$ is
$2.30$, see Figure~\ref{figure:eulerDiffEQ}.
\end{solution}



Let's try this example again with a different initial condition.


\begin{example}\label{example:slopefield2}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 4$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(3)$. 
\end{example}

\begin{solution}
Again we'll use a variation on Euler's Method. Making the table as we
did before, see Table~\ref{table:diffeuler2}.  This time our solution
is simply the function $f(x) = 4$. Note, this does solve the
differential equation as, given
\begin{align*}
f'(x) &= \left(f(x)\right)^2 - 6f(x) + 8\\
0 &= \left(4\right)^2 - 6\cdot4 + 8.
\end{align*}
\end{solution}


\begin{margintable}[0in]
\[
\begin{tchart}{lll}
n & x_n & y_n \\ \hline
0 & 1   & 4 \\
1 & 1.2 & 4\\
2 & 1.4 & 4\\
3 & 1.6 & 4\\
4 & 1.8 & 4\\
5 & 2 & 4\\
6 & 2.2 & 4 \\
7 & 2.4 & 4\\
8 & 2.6 & 4\\
9 & 2.8 & 4\\
10 & 3 & 4
\end{tchart}
\]
\caption{Variation of Euler's Method for the differential equation
  $f'(x) = \left(f(x)\right)^2 - 6f(x) + 8$ with initial condition
  $f(1) = 4$.}
\label{table:diffeuler2}
\end{margintable}

Finally, we'll try do the same example again with another initial
condition.

\begin{margintable}[0in]
\[
\begin{tchart}{lll}
n & x_n & y_n \\ \hline
0 & 1   & 2 \\
1 & 1.2 & 2\\
2 & 1.4 & 2\\
3 & 1.6 & 2\\
4 & 1.8 & 2\\
5 & 2 & 2\\
6 & 2.2 & 2 \\
7 & 2.4 & 2\\
8 & 2.6 & 2\\
9 & 2.8 & 2\\
10 & 3 & 2
\end{tchart}
\]
\caption{Variation of Euler's Method for the differential equation
  $f'(x) = \left(f(x)\right)^2 - 6f(x) + 8$ with initial condition
  $f(1) = 2$.}
\label{table:diffeuler3}
\end{margintable}

\begin{example}\label{example:slopefield3}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 2$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(3)$. 
\end{example}




\begin{solution}
Using the same variation on Euler's Method as before, see
Table~\ref{table:diffeuler3}.  This time our solution is simply the
function $f(x) = 2$. Note, this does solve the differential equation
as, given
\begin{align*}
f'(x) &= \left(f(x)\right)^2 - 6f(x) + 8\\
0 &= \left(2\right)^2 - 6\cdot2 + 8.
\end{align*}
\end{solution}



From our examples above, we see that certain differential equations
can have very different solutions based on initial conditions. To
really see what is happening here, we should look at a \textit{slope
  field}.\index{slope field}

\begin{procedureForConstructingASlopeField}
It is usually easiest to construct a slope field using a computer
algebra system. Nevertheless, the general theory of constructing a
slope field must be understood before one can do this.  Suppose you
have a differential equation relating $f(x)$ and $f'(x)$.
\begin{itemize}
\item Choose a value for $dx$, this will be your step-size.
\item Plot points on an $(x,y)$-plane in increments of size $dx$. 
\item For each point plotted, assume this point is on the curve $f(x)$. 
\item Now use your differential equation to plot an arrow pointing in
  the direction of $(dx,dy)$ from the given point, where $dy =
  f'(x)dx$. This means one draws an arrow in the same direction as the
  arrow from $(x,y)$ to $(x + dx, y + dy)$.
\end{itemize}
\end{procedureForConstructingASlopeField}

Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
if the step-size is $dx =1$, and we are at the point $(3,1)$ then we
should plot an arrow in the same direction as the arrow whose tail is
at $(3,1)$ and whose tip is at
\begin{align*}
(3+1,1 + f'(1))  &= (4, 1 +1 -6+8)\\
&= (4,4).
\end{align*}
Let's examine the slope field for $f(x)$:

{\def\length{sqrt(1+(y^2-6*y+8)^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=0, xmax=5,ymin=0,ymax=5,domain=0:5,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={(y^2 -6*y + 8)/(\length)},scale arrows=.2},-stealth,samples=20] {0};
  \end{axis}
\end{tikzpicture}}

Every solution to the differential equation should follow the arrows
in the slope field.  Compare this slope field to the solutions found
in Example~\ref{example:slopefield1},
Example~\ref{example:slopefield2}, and
Example~\ref{example:slopefield3}. The slope field allows us to
examine each solution of the given differential equation
simultaneously---this often gives more insight into a problem than a
single solution.

\begin{exercises}

\begin{exercise}
You toss a ball from a height height of 1 meter with an upward
velocity of 10 meters per second. What is the velocity of the ball
after 1.25 seconds?
\begin{answer}
$-2.25$ m/s
\end{answer}
\end{exercise}

\begin{exercise}
You toss a ball from a height height of 1.5 meters with an upward
velocity of 12 meters per second. When does the ball hit the ground?
\begin{answer}
$\approx 2.57$ s
\end{answer}
\end{exercise}

\begin{exercise}
A culture of bacteria starts with 250 cells. After 120 minutes, there
are 400 cells. Assuming that the growth rate of the bacteria is
proportional to the number of cells present, estimate when the
culture will have 2000 cells.
\begin{answer}
$531$ minutes
\end{answer}
\end{exercise}

\begin{exercise}
A culture of bacteria starts with 310 cells. After 72 minutes, there
are 500 cells. Assuming that the growth rate of the bacteria is
proportional to the number of cells present, estimate how long it takes the
population to double, and then how much longer it takes for the population to double again.
\begin{answer}
it takes $104.4$ minutes for the population to double each time
\end{answer}
\end{exercise}

\begin{exercise}
Uranium-232 has a half life of 68.9 years. If the rate of decay is
proportional to the amount of uranium-232 and one started with a 10
gram sample, how many grams of uranium-232 are left after 34.45 years?
\begin{answer}
$\approx 7.07$ g
\end{answer}
\end{exercise}


\begin{exercise}
You have a 5 gram sample of neptunium-235. Thirteen days later, you only
have 4.88862 grams of neptunium-235. If the rate of decay is proportional
to the amount of neptunium-235, what is the half-life of neptunium-235?
\begin{answer}
$\approx 400$ days
\end{answer}
\end{exercise}

\begin{exercise}
Consider the differential equation
\[
f'(x) = \left(f(x)\right)^2 - 6f(x) + 8.
\]
Suppose you know that $f(1)= 1$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(2)$. 
\begin{answer}
$1.96$
\end{answer}
\end{exercise}

\begin{exercise}
Consider the differential equation
\[
f'(x) = \frac{f(x)}{2}\left(1-\frac{f(x)}{10}\right)
\]
Suppose you know that $f(4)= 6$. Rounding to two decimals at each
step, use Euler's Method with $h=0.2$ to approximate $f(5)$.
\begin{answer}
$7.14$
\end{answer}
\end{exercise}





\begin{exercise}
In Figure~\ref{figure:slopeFieldExer}, we see a slope field for a
differential equation. If $f(2)=4$, what is your best guess for
$f(5)$?
\begin{answer}
$3$
\end{answer}
\end{exercise}

\begin{exercise}
In Figure~\ref{figure:slopeFieldExer}, we see a slope field for a
differential equation. If $f(1)=1.1$, what is your best guess for
$f(5)$?
\begin{answer}
$3$
\end{answer}
\end{exercise}
\begin{marginfigure}[-2in]
{\def\length{sqrt(1+(-y^2+4*y-3)^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=0, xmax=5,ymin=0,ymax=5,domain=0:5,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={(-y^2 +4*y - 3)/(\length)},scale arrows=.2},-stealth,samples=20] {0};
  \end{axis}
\end{tikzpicture}}
\caption{Here we see a slope field for a differential equation.}
\label{figure:slopeFieldExer}
\end{marginfigure}

\end{exercises}
